//Query to find time to scan a blob for malware when uploaded to storage account
let MalwareScan = StorageMalwareScanningResults
| parse-where BlobUri with * "windows.net" BlobName;
let Blob = StorageBlobLogs
| where OperationName == "GetBlob"
| parse-where Uri with * "windows.net:443" BlobName;
MalwareScan
| join Blob on BlobName 
| extend TimeToScan = datetime_diff('second', ScanFinishedTimeUtc,LastModifiedTime)
| project BlobName, TimeToScan
